!function(i,t){function s(s,e){var a=this,n=s.indexOf("#")?s.replace("#",""):s;this.oWrap=t.getElementById(n),this.imgDatas=[];var o=e||{},c={loop:!1,autoPlay:!1,autoPlayTime:5e3,singleMode:!1,touchSwitch:!0,autoResize:!1,keyControl:!1,showNav:!0};this.config=Object.extend=function(i,t){for(var s in t)t.hasOwnProperty(s)&&(i[s]=t[s]);return i}(c,o),this.config.singleMode&&(this.config.autoPlay=!1),this.renderDOM();var l=null;this.autoPlayTimer=null,this.isPaused=!1,this.isInited=!1,this.resizeFlag=!0,this.toggleFlag=!0,this.config.autoResize&&i.addEventListener("resize",function(){a.resizeFlag&&(a.resizeFlag=!1,i.clearTimeout(l),l=i.setTimeout(function(){i.clearTimeout(a.autoPlayTimer),a.isPaused=!0,a.isInited=!1,a.resize(a.oImg)},400))},!1),this.next.onclick=function(){if(i.clearTimeout(a.autoPlayTimer),a.toggleFlag){if(a.toggleFlag=!1,a.config.loop)a.cindex===a.imgDatas.length-1&&(a.cindex=-1);else if(a.cindex===a.imgDatas.length-1)return a.toggleFlag=!0,!1;return a.cindex++,a["goto"](a.cindex),!1}},this.prev.onclick=function(){if(i.clearTimeout(a.autoPlayTimer),a.toggleFlag){if(a.toggleFlag=!1,a.config.loop)0===a.cindex&&(a.cindex=a.imgDatas.length);else if(0===a.cindex)return a.toggleFlag=!0,!1;return a.cindex--,a["goto"](a.cindex),!1}},this.config.keyControl&&!this.config.singleMode&&i.addEventListener("keyup",function(t){if(a.isInited){var s=t||i.event,e=s.which;38==e||37==e?a.prev.onclick():39!=e&&40!=e||a.next.onclick()}},!1),this.play.onclick=function(){this.style.display="none",a.pause.style.display="block",a.isPaused=!1,a.autoPlay()},this.pause.onclick=function(){a.play.style.display="block",this.style.display="none",a.isPaused=!0,i.clearTimeout(a.autoPlayTimer)},this.config.touchSwitch&&!this.config.singleMode&&this.swipe(this.oBox,function(i){switch(i){case"swipeLeft":a.next.onclick();break;case"swipeRight":a.prev.onclick()}}),this.DPicsWrap.onclick=function(t){var s=t||i.event;s.target===s.currentTarget&&a.close.onclick()},this.close.onclick=function(){if(a.isInited)return a.isPaused=!0,a.isInited=!1,i.clearTimeout(a.autoPlayTimer),a.DPicsWrap.style.display="none",a.DPicsBox.style.opacity=0,a.DPicsBox.style.width=a.DPicsBox.style.height="200px",a.DPicsBox.style.marginLeft=a.DPicsBox.style.marginTop="-100px",!1}}s.prototype.swipe=function(t,s){var e,a=0,n=0,o=null;t.addEventListener("touchmove",function(t){var s=t||i.event;s.preventDefault()},!1),t.addEventListener("touchstart",function(t){var s=t||i.event;a=s.touches[0].pageX,e=1*new Date},!1),t.addEventListener("touchend",function(t){var c=t||i.event;n=c.changedTouches[0].pageX,o=1*new Date,s&&(o-e<100?n-a<0?s("swipeLeft"):n-a>0&&s("swipeRight"):o-e<500&&(n-a<-50?s("swipeLeft"):n-a>50&&s("swipeRight")))},!1)},s.prototype.autoPlay=function(){var t=this;this.config.autoPlay&&this.isInited&&!this.config.singleMode&&(this.autoPlayTimer=i.setTimeout(function(){t.next.onclick()},t.config.autoPlayTime))},s.prototype.init=function(t){function s(){for(var i=[],t=0;t<a.length;t++)a[t].className.indexOf("DPics-item")>-1&&i.push(a[t]);return i}if(!t||!(t instanceof Array)||t.length<1)throw new Error("error caused when initializing constructor. Initial data should be an [Array] type and it's length should be more than one");var e=this;this.imgDatas=t;var a=this.oWrap.getElementsByTagName("img"),n=s();n.forEach(function(i,t){i.index=t});var o=function(t){var s=t||i.event,a=s.target;return a!==s.currentTarget&&void("IMG"===a.nodeName&&a.className.indexOf("DPics-item")>-1&&(e.cindex=parseInt(a.index),i.setTimeout(function(){e.DPicsBox.style.opacity=1},50),e["goto"](e.cindex)))};this.oWrap.removeEventListener("click",o,!1),this.oWrap.addEventListener("click",o,!1)},s.prototype["goto"]=function(i){var t=this;this.isInited=!1,this.nav.style.opacity=0,this.nav.style.visibility="hidden",t.desc.className="DPics-desc",this.preLoadImg(i,function(i){t.loading.style.opacity=0,t.page.innerHTML="<i>"+parseInt(t.cindex+1)+" / "+t.imgDatas.length+"</i>",t.title.innerHTML=t.imgDatas[t.cindex].title||"",t.desc.innerHTML=t.imgDatas[t.cindex].desc||"",t.imgDatas[t.cindex].desc?t.desc.style.display="block":t.desc.style.display="none",t.resize(i)}),this.DPicsWrap.style.display="block"},s.prototype.preLoadImg=function(t,s){var e=this,a=new Image;this.oImg.style.opacity=0,this.oImg.style.visibility="hidden",this.loading.style.opacity=1,i.setTimeout(function(){e.oImg.src=a.src=e.imgDatas[t].src,a.onload=function(){s&&s(e.oImg)}},300)},s.prototype.resize=function(s){var e=this,a=t.documentElement.clientWidth,n=t.documentElement.clientHeight;s.style.width=s.style.height="auto";var o=s.width,c=s.height,l=a<470?83:45,d=Math.min(a/o,n/c,1);o=d<1?Math.ceil(o*d-60):Math.ceil(o*d),c=d<1?Math.ceil(c*d-60):Math.ceil(c*d),s.style.width=o+"px",s.style.height=c+"px",this.DPicsBox.style.width=o+"px",this.DPicsBox.style.height=this.config.showNav?c+l+"px":c+"px",this.DPicsBox.style.marginLeft=-(o+10)/2+"px",this.DPicsBox.style.marginTop=this.config.showNav?-(c+l+10)/2+"px":-(c+10)/2+"px",e.isPaused&&e.config.autoPlay&&(e.play.style.display="block",e.pause.style.display="none"),i.setTimeout(function(){e.nav.style.opacity=s.style.opacity=1,e.nav.style.visibility=s.style.visibility="visible",e.desc.className="DPics-desc show-desc",e.resizeFlag=!0,e.toggleFlag=!0,e.isInited=!0,!e.isPaused&&e.autoPlay()},530)},s.prototype.renderDOM=function(){function i(i){return t.getElementById(i)}this.DPicsWrap=t.createElement("div"),this.DPicsWrap.id=this.oWrap.id+"-pop",this.DPicsWrap.className="DPics-wrap",this.DPicsBox=t.createElement("div"),this.DPicsBox.className="DPics-box";var s='<div id="'+this.oWrap.id+'-DPics-imgBox" class="DPics-imgBox"><img id="'+this.oWrap.id+'-DPics-img"><p id="'+this.oWrap.id+'-DPics-desc" class="DPics-desc"></p></div><div id="'+this.oWrap.id+'-DPics-loading" class="DPics-loading"><div class="DPics-spinner"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div></div><div id="'+this.oWrap.id+'-DPics-nav" class="DPics-nav"><div id="'+this.oWrap.id+'-DPics-close" class="DPics-close"></div><div class="DPics-control"><div id="'+this.oWrap.id+'-DPicsPlay" class="DPics-play-pause play"></div><div id="'+this.oWrap.id+'-DPicsPause" class="DPics-play-pause pause"></div><div id="'+this.oWrap.id+'-DPics-prev" class="DPics-prev-next-btn prev-btn"></div><div id="'+this.oWrap.id+'-DPics-next" class="DPics-prev-next-btn next-btn"></div><span id="'+this.oWrap.id+'-DPics-page" class="DPics-page"></span></div><p id="'+this.oWrap.id+'-DPics-title" class="DPics-title"></p></div>';this.DPicsWrap.appendChild(this.DPicsBox),this.DPicsBox.innerHTML=s,t.body.appendChild(this.DPicsWrap),this.oBox=i(""+this.oWrap.id+"-DPics-imgBox"),this.oImg=i(""+this.oWrap.id+"-DPics-img"),this.nav=i(""+this.oWrap.id+"-DPics-nav"),this.page=i(""+this.oWrap.id+"-DPics-page"),this.title=i(""+this.oWrap.id+"-DPics-title"),this.desc=i(""+this.oWrap.id+"-DPics-desc"),this.prev=i(""+this.oWrap.id+"-DPics-prev"),this.next=i(""+this.oWrap.id+"-DPics-next"),this.play=i(""+this.oWrap.id+"-DPicsPlay"),this.pause=i(""+this.oWrap.id+"-DPicsPause"),this.loading=i(""+this.oWrap.id+"-DPics-loading"),this.close=i(""+this.oWrap.id+"-DPics-close"),this.config.showNav||(this.nav.style.display="none"),this.config.singleMode&&(this.prev.style.display=this.next.style.display=this.play.style.display="none"),!this.config.autoPlay||this.config.singleMode?this.play.style.display=this.pause.style.display="none":(this.play.style.display="none",this.pause.style.display="block")},i.DPicsViewer=s}(window,document);